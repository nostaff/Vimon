<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>searchbar/searchbar.vue - Documentation</title>
    <meta name="viewport"
          content="width=device-width, initial-scale=1, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <script src="scripts/qrcode.js"></script>
    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc.css">
    <link type="text/css" rel="stylesheet" href="styles/custom.css">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav>

    <section class="vimo">
        <div class="vimo__imgBox">
            <img class="vimo__imgBox--img" src="./asset/img/vimo.png">
        </div>

        <div class="vimo__title">
            <h2>VIMON</h2>
            <!--<p>beta</p>-->
            <p>基于Vue2.x的移动端Hybrid框架</p>
        </div>
        <div class="vimo__iframe">
            <iframe src="https://ghbtns.com/github-btn.html?user=nostaff&amp;repo=Vimon&amp;type=star&amp;count=true"
                    frameborder="0" scrolling="0" width="110px" height="20px"
                    class="enter-transition"
                    style=""></iframe>
            <iframe src="https://ghbtns.com/github-btn.html?user=nostaff&amp;repo=Vimon&amp;type=fork&amp;count=true"
                    frameborder="0" scrolling="0" width="95px" height="20px"
                    class="enter-transition"
                    style=""></iframe>
        </div>
    </section>
    <section class="nav__header"><h2><a href="index.html">首页 / Home</a></h2><h2><a href="https://nostaff.github.io/vimon/example">示例 / Demo</a></h2><h2><a href="https://nostaff.github.io/vimon/">如何开始 / How To Start</a></h2><h2><a href="https://github.com/nostaff/vimon/blob/master/CHANGELOG.md">更新日志 / Change Log</a></h2><h2><a href="#">常见问题 / Question</a></h2></section><h3>组件 / Components</h3><ul><li><a href="component-ActionSheet.html">ActionSheet</a><ul class='methods'><li data-type='method'><a href="component-ActionSheet.html#~dismiss">dismiss</a></li><li data-type='method'><a href="component-ActionSheet.html#~present">present</a></li></ul></li><li><a href="component-Alert.html">Alert</a><ul class='methods'><li data-type='method'><a href="component-Alert.html#~dismiss">dismiss</a></li><li data-type='method'><a href="component-Alert.html#~present">present</a></li></ul></li><li><a href="component-App.html">App</a></li><li><a href="component-Avatar.html">Avatar</a></li><li><a href="component-Backdrop.html">Backdrop</a></li><li><a href="component-Badge.html">Badge</a></li><li><a href="component-Base_Footer.html">Base/Footer</a></li><li><a href="component-Base_Header.html">Base/Header</a></li><li><a href="component-Base_Navbar.html">Base/Navbar</a></li><li><a href="component-Base_Page.html">Base/Page</a></li><li><a href="component-Button.html">Button</a></li><li><a href="component-Checkbox.html">Checkbox</a></li><li><a href="component-ChooseCity.html">ChooseCity</a></li><li><a href="component-CityPicker.html">CityPicker</a></li><li><a href="component-Content.html">Content</a></li><li><a href="component-Grid.html">Grid</a></li><li><a href="component-Grid_Column.html">Grid/Column</a></li><li><a href="component-Grid_Row.html">Grid/Row</a></li><li><a href="component-Icon.html">Icon</a></li><li><a href="component-Img.html">Img</a></li><li><a href="component-InfiniteScroll.html">InfiniteScroll</a></li><li><a href="component-Input.html">Input</a></li><li><a href="component-Item.html">Item</a></li><li><a href="component-Item_ItemDivider.html">Item/ItemDivider</a></li><li><a href="component-Item_ItemGroup.html">Item/ItemGroup</a></li><li><a href="component-Item_ItemOptions.html">Item/ItemOptions</a></li><li><a href="component-Item_ItemSliding.html">Item/ItemSliding</a></li><li><a href="component-Item_ListHeader.html">Item/ListHeader</a></li><li><a href="component-Label.html">Label</a></li><li><a href="component-List.html">List</a></li><li><a href="component-Loading.html">Loading</a></li><li><a href="component-Menu.html">Menu</a><ul class='methods'><li data-type='method'><a href="component-Menu.html#~close">close</a></li><li data-type='method'><a href="component-Menu.html#~open">open</a></li><li data-type='method'><a href="component-Menu.html#~toggle">toggle</a></li></ul></li><li><a href="component-Modal.html">Modal</a><ul class='methods'><li data-type='method'><a href="component-Modal.html#~dismiss">dismiss</a></li><li data-type='method'><a href="component-Modal.html#~present">present</a></li></ul></li><li><a href="component-Nav.html">Nav</a></li><li><a href="component-Note.html">Note</a></li><li><a href="component-Picker.html">Picker</a></li><li><a href="component-Popover.html">Popover</a></li><li><a href="component-PopSheet.html">PopSheet</a></li><li><a href="component-Radio.html">Radio</a></li><li><a href="component-Range.html">Range</a></li><li><a href="component-Refresher.html">Refresher</a></li><li><a href="component-Scroll.html">Scroll</a></li><li><a href="component-Searchbar.html">Searchbar</a></li><li><a href="component-Segment.html">Segment</a></li><li><a href="component-Segment_SegmentButton.html">Segment/SegmentButton</a></li><li><a href="component-Select.html">Select</a></li><li><a href="component-Select_Option.html">Select/Option</a></li><li><a href="component-Sheet.html">Sheet</a></li><li><a href="component-Slides.html">Slides</a></li><li><a href="component-Slides_Slide.html">Slides/Slide</a></li><li><a href="component-Spinner.html">Spinner</a></li><li><a href="component-Tabs.html">Tabs</a></li><li><a href="component-Tabs_Tab.html">Tabs/Tab</a></li><li><a href="component-Textarea.html">Textarea</a></li><li><a href="component-Thumbnail.html">Thumbnail</a></li><li><a href="component-Toast.html">Toast</a></li><li><a href="component-Toggle.html">Toggle</a></li><li><a href="component-Toolbar.html">Toolbar</a></li><li><a href="component-Toolbar_Buttons.html">Toolbar/Buttons</a></li><li><a href="component-Toolbar_Title.html">Toolbar/Title</a></li></ul><h3>Global</h3><ul><li><a href="global.html#currentY">currentY</a></li><li><a href="global.html#deltaY">deltaY</a></li><li><a href="global.html#destroy">destroy</a></li><li><a href="global.html#dismiss">dismiss</a></li><li><a href="global.html#fabLists">fabLists</a></li><li><a href="global.html#findReorderItem">findReorderItem</a></li><li><a href="global.html#getHeight">getHeight</a></li><li><a href="global.html#getLeft">getLeft</a></li><li><a href="global.html#getTitle">getTitle</a></li><li><a href="global.html#getTop">getTop</a></li><li><a href="global.html#getWidth">getWidth</a></li><li><a href="global.html#hide">hide</a></li><li><a href="global.html#hideOptionButton">hideOptionButton</a></li><li><a href="global.html#indexForItem">indexForItem</a></li><li><a href="global.html#listsActive">listsActive</a></li><li><a href="global.html#mainButton">mainButton</a></li><li><a href="global.html#present">present</a></li><li><a href="global.html#progress">progress</a></li><li><a href="global.html#reset">reset</a></li><li><a href="global.html#resize">resize</a></li><li><a href="global.html#scrollBy">scrollBy</a></li><li><a href="global.html#scrollTo">scrollTo</a></li><li><a href="global.html#scrollToBottom">scrollToBottom</a></li><li><a href="global.html#scrollToElement">scrollToElement</a></li><li><a href="global.html#scrollToTop">scrollToTop</a></li><li><a href="global.html#setClass">setClass</a></li><li><a href="global.html#setDisableScroll">setDisableScroll</a></li><li><a href="global.html#setDocTitle">setDocTitle</a></li><li><a href="global.html#setEnabled">setEnabled</a></li><li><a href="global.html#setFocus">setFocus</a></li><li><a href="global.html#setLeft">setLeft</a></li><li><a href="global.html#setStyle">setStyle</a></li><li><a href="global.html#setTitle">setTitle</a></li><li><a href="global.html#setTop">setTop</a></li><li><a href="global.html#show">show</a></li><li><a href="global.html#showOptionButton">showOptionButton</a></li><li><a href="global.html#showPopMenu">showPopMenu</a></li><li><a href="global.html#startY">startY</a></li><li><a href="global.html#state">state</a></li><li><a href="global.html#toggle">toggle</a></li><li><a href="global.html#update">update</a></li></ul>
</nav>

<div id="main">

    <article class="content">

        
        <h1 class="page-title">searchbar/searchbar.vue</h1>
        

        




    <section>
        <article>
            <pre class="prettyprint source linenums"><code>&lt;template>
  &lt;div class="ion-searchbar" :class="[
         modeClass,colorClass,
         {'searchbar-has-focus':sbHasFocus},
         {'searchbar-has-value':theValue},
         {'searchbar-animated':shouldAnimated},
         {'searchbar-active':sbHasFocus},
         {'searchbar-show-cancel':showCancelButton},
         {'searchbar-left-aligned':shouldAlignLeft}
         ]">
    &lt;div class="searchbar-input-container" @touchstart="setFocus">
      &lt;!--在md模式下，md的取消按钮是在这里的，当点击inputs输入时，返回按钮将覆盖search按钮-->
      &lt;vm-button mode="md" @click.native="cancelSearchbar($event)" clear color="dark" class="searchbar-md-cancel" role="button">
        &lt;vm-icon mode="md" name="md-arrow-back">&lt;/vm-icon>
      &lt;/vm-button>

      &lt;!--input左边的search按钮-->
      &lt;div ref="searchbarIcon" class="searchbar-search-icon">&lt;/div>
      &lt;input ref="searchbarInput" class="searchbar-input" id="searchbarInput" @input="onInputHandler($event)" @blur="onBlurHandler($event)" @focus="onFocusHandler($event)" :value="theValue" :placeholder="placeholder" :type="type" :autocomplete="autocompleteValue" :autocorrect="autocorrectValue" :spellcheck="spellcheckValue">
      &lt;!--input右边的关闭按钮-->
      &lt;vm-button clear class="searchbar-clear-icon" :mode="mode" @click.native="clearInput($event)" role="button">&lt;/vm-button>
    &lt;/div>

    &lt;!--取消按钮，点击input时出现，只对IOS，md在search icon位置显示，wp没有-->
    &lt;vm-button ref="cancelButton" mode="ios" clear @click.native="cancelSearchbar($event)" class="searchbar-ios-cancel" role="button">
      {{cancelButtonText}}
    &lt;/vm-button>
  &lt;/div>
&lt;/template>

&lt;script type="text/javascript">
import { isNumber, isBoolean } from '../../util/util'
import ModeMixins from '../../themes/theme.mixins'
import VmButton from '../button'
import VmIcon from '../icon'

export default {
  name: 'vm-searchbar',
  mixins: [ModeMixins],
  components: {
    VmButton,
    VmIcon
  },
  data () {
    return {
      isCancelVisible: false,
      sbHasFocus: false,
      shouldAlignLeft: true,
      shouldBlur: true,
      shouldAnimated: false,

      // 三个元素的id的document实例
      searchbarIconElement: '',
      searchbarInputElement: '',
      cancelButtonElement: '',

      // 外部的value映射
      theValue: this.value,
      timer: '',

      placeHolderTextWidth: null // number eg: 44
    }
  },
  props: {
    /**
       * Set the the cancel button text. Default: "Cancel".
       */
    cancelButtonText: {
      type: String,
      default: 'Cancel'
    },
    /**
       * Whether to show the cancel button or not. Default: "false".
       */
    showCancelButton: [Boolean],
    /**
       * How long, in milliseconds, to wait to trigger the onInput event after each keystroke. Default 250.
       */
    debounce: {
      type: Number,
      default: 0
    },
    /**
       * Set the input's placeholder. Default "Search".
       */
    placeholder: {
      type: String,
      default: 'Search'
    },
    /**
       * Set the input's autocomplete property. Values: "on", "off". Default "off".
       */
    autocomplete: {
      type: String,
      default: 'off'
    },
    /**
       * Set the input's autocorrect property. Values: "on", "off". Default "off".
       */
    autocorrect: {
      type: String,
      default: 'off'
    },

    autofocus: [Boolean, Number],
    /**
       * Set the input's spellcheck property. Values: true, false. Default false.
       */
    spellcheck: {
      type: [String, Boolean],
      default: false
    },
    /**
       * Set the type of the input. Values: "text", "password", "email", "number", "search", "tel", "url". Default "search".
       */
    type: {
      type: String,
      default: 'search'
    },
    /**
       * Configures if the searchbar is animated or no. By default, animation is false.
       */
    animated: {
      type: Boolean,
      default: false
    },
    /**
       * Set the input value.
       */
    value: String
  },
  watch: {
    value (val) {
      this.theValue = val
      this.positionElements()
    }
  },
  computed: {
    // props处理
    autocompleteValue () {
      return this.autocomplete === '' || this.autocomplete === 'on'
        ? 'on'
        : 'off'
    },
    autocorrectValue () {
      return this.autocorrect === '' || this.autocorrect === 'on'
        ? 'on'
        : 'off'
    },
    spellcheckValue () {
      return (
        this.spellcheck === '' ||
        this.spellcheck === 'true' ||
        this.spellcheck === true
      )
    }
  },
  methods: {
    // -------- public --------
    /**
       * @function setFocus
       * @description
       * 手动设置当前input的focus状态
       */
    setFocus () {
      this.searchbarInputElement.focus()
    },

    // -------- private --------
    /**
       * Update the Searchbar input value when the input changes
       * @private
       */
    onInputHandler ($event) {
      let _valueInner = $event.target ? $event.target.value : ''
      if (_valueInner) {
        this.theValue = _valueInner
      } else {
        this.theValue = null
      }

      if (this.debounce > 16) {
        window.clearTimeout(this.timer)
        this.timer = window.setTimeout(() => {
          // 通知父组件的v-model
          this.$emit('input', this.theValue)

          this.$emit('onInput', $event)
        }, this.debounce)
      } else {
        /**
           * @event component:Searchbar#onInput
           * @description input事件
           * @property {object} $event - 事件对象
           */
        this.$emit('input', this.theValue)
        this.$emit('onInput', $event)
      }
    },

    /**
       * Sets the Searchbar to focused and active on input focus.
       * @private
       */
    onFocusHandler ($event) {
      /**
         * @event component:Searchbar#onFocus
         * @description focus事件
         * @property {object} $event - 事件对象
         */
      this.$emit('onFocus', $event)
      this.sbHasFocus = true
      this.positionElements()
    },

    /**
       * Sets the Searchbar to not focused and checks if it should align left
       * based on whether there is a value in the searchbar or not.
       * @private
       */
    onBlurHandler ($event) {
      // shouldBlur: 是否真正的blur, 因为当点击clearBtn时, 需要再次focus, 所以等到16*4ms后, 判断是否blue
      // shouldBlur determines if it should blur
      // if we are clearing the input we still want to stay focused in the input
      // wait for DOM update, because of focus method
      window.setTimeout(() => {
        if (!this.shouldBlur) {
          this.sbHasFocus = true
          this.searchbarInputElement.focus()
        } else {
          /**
             * @event component:Searchbar#onBlur
             * @description blur事件
             * @property {object} $event - 事件对象
             */
          this.$emit('onBlur', $event)
          this.sbHasFocus = false
          this.positionElements()
        }
        this.shouldBlur = true
      }, 16 * 4)
    },
    /**
       * Clears the input field and triggers the control change.
       * @private
       */
    clearInput ($event) {
      this.searchbarInputElement.focus()
      /**
         * @event component:Searchbar#onClear
         * @description clear事件
         * @property {object} $event - 事件对象
         */
      this.$emit('onClear', $event)
      this.shouldBlur = false
      if (this.theValue) {
        this.theValue = null
        this.$emit('input', this.theValue)
        this.$emit('onInput', $event)
      }
    },
    /**
       * Clears the input field and tells the input to blur since
       * the clearInput function doesn't want the input to blur
       * then calls the custom cancel function if the user passed one in.
       * @private
       */
    cancelSearchbar ($event) {
      /**
         * @event component:Searchbar#onCancel
         * @description cancel事件
         * @property {object} $event - 事件对象
         */
      this.$emit('onCancel', $event)
      if (this.theValue) {
        this.theValue = null
        this.$emit('input', this.theValue)
        this.$emit('onInput', $event)
      }
      this.shouldBlur = true
    },

    /**
       * 当focus时, 设置搜索框的icon/placeholder/cancel button的位置 (ios only)
       * @private
       */
    positionElements () {
      let isAnimated = this.animated
      let prevAlignLeft = this.shouldAlignLeft
      let shouldAlignLeft =
        !isAnimated ||
        (this.theValue &amp;&amp; this.theValue.toString().trim() !== '') ||
        this.sbHasFocus === true
      this.shouldAlignLeft = shouldAlignLeft

      if (this.mode !== 'ios') {
        return
      }

      if (prevAlignLeft !== shouldAlignLeft) {
        this.positionPlaceholder()
      }
      if (isAnimated) {
        this.positionCancelButton()
      }
      this.shouldAnimated = this.animated
    },

    positionPlaceholder () {
      let inputEle = this.searchbarInputElement
      let iconEle = this.searchbarIconElement
      console.assert(
        inputEle,
        'The input element is undefined, please check!::&lt;Function>positionPlaceholder():inputEle'
      )
      console.assert(
        iconEle,
        'The icon element is undefined, please check!::&lt;Function>positionPlaceholder():iconEle'
      )
      if (!inputEle || !iconEle) {
        return
      }

      if (this.shouldAlignLeft) {
        inputEle.removeAttribute('style')
        iconEle.removeAttribute('style')
      } else {
        if (this.sbHasFocus) {
          this.searchbarInputElement.blur()
        }

        if (this.placeHolderTextWidth === null) {
          // Create a dummy span to get the placeholder width
          if (!this.placeholder) {
            this.placeHolderTextWidth = 0
          } else {
            let tempSpan = document.createElement('span')
            tempSpan.innerHTML = this.placeholder
            tempSpan.style.fontSize = window.getComputedStyle(
              inputEle
            ).fontSize
            tempSpan.style.display = 'inline'
            document.body.appendChild(tempSpan)

            // Get the width of the span then remove it
            this.placeHolderTextWidth = tempSpan.offsetWidth
            tempSpan.remove()
          }
        }

        // Set the input padding left
        let inputLeft = 'calc(50% - ' + this.placeHolderTextWidth / 2 + 'px)'
        inputEle.style.paddingLeft = inputLeft

        let paddingLeft = this.placeHolderTextWidth === 0 ? 14 : 30
        // Set the icon margin left
        let iconLeft =
          'calc(50% - ' + (this.placeHolderTextWidth / 2 + paddingLeft) + 'px)'
        iconEle.style.marginLeft = iconLeft
      }
    },

    /**
       * Show the iOS Cancel button on focus, hide it offscreen otherwise
       * @private
       */
    positionCancelButton () {
      if (!this.cancelButtonElement) {
        return
      }
      let showShowCancel = this.sbHasFocus
      if (showShowCancel !== this.isCancelVisible) {
        let cancelStyleEle = this.cancelButtonElement
        let cancelStyle = cancelStyleEle.style
        this.isCancelVisible = showShowCancel
        if (showShowCancel) {
          cancelStyle.marginRight = '0'
        } else {
          let offset = cancelStyleEle.offsetWidth
          if (offset > 0) {
            cancelStyle.marginRight = -offset + 'px'
          }
        }
      }
    }
  },
  mounted () {
    this.searchbarIconElement = this.$refs.searchbarIcon
    this.searchbarInputElement = this.$refs.searchbarInput
    this.cancelButtonElement = this.$refs.cancelButton.$el
    this.positionElements()

    if (isBoolean(this.autofocus) &amp;&amp; this.autofocus) {
      this.setFocus()
    }

    if (isNumber(this.autofocus) &amp;&amp; this.autofocus > 0) {
      window.setTimeout(() => {
        this.setFocus()
      }, this.autofocus)
    }
  }
}
&lt;/script>

&lt;style lang="scss">
@import "searchbar";
@import "searchbar.ios";
@import "searchbar.md";
&lt;/style>

</code></pre>
        </article>
    </section>





    </article>
</div>

<br class="clear">

<footer>
    文档根据<a href="ttps://github.com/nostaff/vimon">Vimon源码</a>, 由<a href="https://github.com/jsdoc3/jsdoc">JSDoc3.5.5</a>自动生成。
</footer>

<script>prettyPrint();</script>
<script src="scripts/linenumber.js"></script>
</body>
</html>
